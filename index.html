<!DOCTYPE html>
<html lang="lb">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>P2 – Zuelen a Faarwen – Spiller</title>
<style>
  /* Font */
  @font-face{
    font-family:'Schoulschreft';
    src:url('https://github.com/albrechtclaire1007/schoulschreft/raw/main/schoulschreft_bold%5B2%5D.TTF') format('truetype');
    font-weight:bold; font-style:normal;
  }

  :root{
    --green:#d5ebd4;
    --black:#111;
    --white:#fff;
    --red:#ffcccc;
    --border:3px;
  }

  *{box-sizing:border-box; -webkit-tap-highlight-color:transparent; user-select:none; outline:none;}
  html,body{height:100%; margin:0; background:var(--white); color:var(--black); font-family:'Schoulschreft', Arial, sans-serif;}

  .wrap{
    min-height:100%;
    display:flex; flex-direction:column; align-items:center;
    gap:3vmin; padding:3vmin 3vmin 4vmin;
  }
  h1{margin:0; text-align:center; font-size:clamp(2.2rem, 6vmin, 5rem);}

  /* Top navigation */
  .top{
    position:sticky; top:8px; z-index:10; display:flex; gap:10px; align-items:center;
    background:var(--white); border:var(--border) solid var(--green); border-radius:18px;
    padding:.35rem .6rem;
  }
  .btn{
    border:var(--border) solid var(--black); background:var(--white); color:var(--black);
    padding:.45rem .85rem; border-radius:14px; cursor:pointer; font-size:1.05rem;
    font-family:'Schoulschreft', Arial, sans-serif;
  }
  .btn:active{ transform:scale(.98); }
  .flow{opacity:.85; font-size:1rem; padding:0 .2rem; min-width:7ch; text-align:center;}

  .hidden{display:none !important;}

  /* Audio button */
  .audioBar{ display:flex; align-items:center; gap:.6rem; }
  .playBtn{
    width:56px; height:56px; border-radius:50%;
    border:var(--border) solid var(--black); background:var(--green);
    display:grid; place-items:center; font-size:1.3rem; cursor:pointer;
  }

  /* Grids */
  .grid{
    width:95vw; max-width:2000px;
    display:grid; gap:2vmin;
    grid-template-columns: repeat(auto-fill, minmax(12vmin, 1fr));
    align-items:stretch;
  }

  /* Tokens */
  .numToken{
    background:var(--white); border:6px solid var(--green); border-radius:999px;
    display:grid; place-items:center;
    height:clamp(110px, 14vmin, 340px);
    font-family:'Schoulschreft', Arial, sans-serif;
    font-size:clamp(2rem, 9vmin, 7rem);
    cursor:pointer;
    transition:transform .1s ease, background .15s ease, border-color .15s ease;
  }
  .numToken:active{ transform:scale(.96); }

  .wordToken{
    background:var(--green); border:6px solid var(--green); border-radius:22px;
    display:flex; align-items:center; justify-content:center;
    padding:1.2vmin 1.6vmin;
    min-height:clamp(90px, 12vmin, 280px);
    text-align:center; cursor:pointer;
    transition:transform .1s ease, background .15s ease, border-color .15s ease, filter .15s ease;
    font-size:clamp(2.2rem, 5.5vmin, 4rem);
    font-family:'Schoulschreft', Arial, sans-serif;
  }
  .wordToken:active{ transform:scale(.97); }

  /* Feedback flashes for games 1 & 2 */
  .flash-good{ background:var(--green) !important; filter:brightness(1.04); }
  .flash-bad{ background:var(--red) !important; border-color:var(--red) !important; }

  /* Game 3 letters */
  .letterArea{ width:95vw; max-width:2000px; display:flex; flex-direction:column; gap:2vmin; align-items:center; }
  .slots,.bank{
    display:flex; flex-wrap:wrap; gap:10px; justify-content:center;
    padding:14px; border:var(--border) dashed var(--green); border-radius:18px; min-height:72px; background:var(--white);
  }
  .letter{
    background:var(--green); color:var(--black); border:var(--border) solid var(--green);
    border-radius:15px; padding:.45rem .7rem; font-size:clamp(1.4rem,4.5vw,2rem);
    cursor:grab; touch-action:none;
  }
  .slot{
    width:2.2em; height:2.2em; border:var(--border) solid var(--green); border-radius:12px;
    display:grid; place-items:center; font-size:clamp(1.4rem,4.5vw,2rem); background:var(--white);
  }
  .goodFlash{ background:var(--green) !important; transition:background .18s ease; }
  .badFlash{ background:var(--red) !important; transition:background .18s ease; }

  /* Big number square */
  .bigSquare{
    width:min(95vmin,100%); aspect-ratio:1/1; background:#fff;
    border:12px solid var(--green); border-radius:40px; display:grid; place-items:center;
    font-size:min(45vmin,30rem); font-weight:800; position:relative; cursor:pointer;
    box-shadow:0 10px 30px rgba(0,0,0,.08);
    transition:transform .15s ease, background-color .2s ease, color .2s ease;
  }
  .bigSquare:active{ transform:scale(.97); background:var(--green); color:#000; }
  .reset{
    position:absolute; top:14px; right:18px; width:48px; height:48px; border-radius:50%;
    background:#fff; border:4px solid var(--green); display:grid; place-items:center;
    font-size:1.4rem; line-height:1; cursor:pointer;
  }

  .fade{ animation:fadeIn .35s ease; }
  @keyframes fadeIn{ from{opacity:0; transform:scale(.9)} to{opacity:1; transform:scale(1)} }

  /* Sentence squares */
  .sentence{ display:flex; align-items:center; gap:min(2vmin,16px); flex-wrap:wrap; justify-content:center; font-size:clamp(2rem,4.5vw,3.2rem); }
  .inlineSq{
    display:inline-grid; place-items:center; width:min(36vmin,420px); aspect-ratio:1/1;
    border:10px solid var(--green); border-radius:28px; background:#fff; cursor:pointer;
    box-shadow:0 8px 24px rgba(0,0,0,.08); font-size:min(22vmin,12rem); transition:transform .12s ease;
  }
  .inlineSq:active{ transform:scale(.97); }
</style>
</head>
<body>

<div class="top">
  <button class="btn" id="prev">Zréck</button>
  <span class="flow" id="flowLabel">1. Spill</span>
  <button class="btn" id="next">Weider</button>
</div>

<!-- Spill 1 -->
<section class="wrap" id="g1">
  <h1>Lauschter a klick op déi richteg Zuel</h1>
  <div class="audioBar"><button class="playBtn" id="play1" title="Ofspillen">▶</button></div>
  <div class="grid" id="grid1"></div>
</section>

<!-- Spill 2 -->
<section class="wrap hidden" id="g2">
  <h1>Lauschter a klick op dat richtegt Wuert</h1>
  <div class="audioBar"><button class="playBtn" id="play2" title="Ofspillen">▶</button></div>
  <div class="grid" id="grid2"></div>
</section>

<!-- Spill 3 -->
<section class="wrap hidden" id="g3">
  <h1>Lauschter a schreif d'Wuert mat de Buschtawen</h1>
  <div class="audioBar">
    <button class="playBtn" id="play3" title="Ofspillen">▶</button>
    <button class="btn" id="reset3">Zerécksetzen</button>
  </div>
  <div class="letterArea">
    <div class="slots" id="slots"></div>
    <div class="bank" id="bank"></div>
  </div>
</section>

<!-- Spill 4 -->
<section class="wrap hidden" id="g4">
  <h1>Klick a so d’Zuel</h1>
  <div class="bigSquare" id="bigSquare">
    <div id="bigNum">—</div>
    <button class="reset" id="bigReset" title="Nei ufänken">↻</button>
  </div>
</section>

<!-- Spill 5 -->
<section class="wrap hidden" id="g5">
  <h1>Lies de Saz</h1>
  <div class="sentence">
    <span>D’</span>
    <div class="inlineSq" id="numSq"><span id="numSqVal">1</span></div>
    <span>ass</span>
    <div class="inlineSq" id="colSq"></div>
    <span>.</span>
  </div>
  <div><button class="btn" id="reshuffleBoth">Nei mëschen</button></div>
</section>

<audio id="speaker" preload="auto"></audio>

<script>
/* Shared */
const AUDIO_BASE = "https://github.com/albrechtclaire1007/zuelen1-20kub/raw/refs/heads/main/";
const audioUrl = n => `${AUDIO_BASE}${n}.mp3`;
const WORDS = {
  1:"eent", 2:"zwee", 3:"dräi", 4:"véier", 5:"fënnef",
  6:"sechs", 7:"siwen", 8:"aacht", 9:"néng", 10:"zéng",
  11:"eelef", 12:"zwielef", 13:"dräizéng", 14:"véierzéng", 15:"fofzéng",
  16:"siechzéng", 17:"siwwenzéng", 18:"uechtzéng", 19:"nonzéng", 20:"zwanzeg"
};
const COLOURS = [
  {name:'wäiss', hex:'#FFFFFF', text:'#111'},
  {name:'schwaarz', hex:'#1F1F1F', text:'#FFFFFF'},
  {name:'rout', hex:'#E53935', text:'#FFFFFF'},
  {name:'brong', hex:'#8D6E63', text:'#FFFFFF'},
  {name:'orange', hex:'#FB8C00', text:'#FFFFFF'},
  {name:'giel', hex:'#FFD54F', text:'#111'},
  {name:'gréng', hex:'#66BB6A', text:'#FFFFFF'},
  {name:'donkelgréng', hex:'#1B5E20', text:'#FFFFFF'},
  {name:'hellblo', hex:'#29B6F6', text:'#FFFFFF'},
  {name:'donkelblo', hex:'#1E3A8A', text:'#FFFFFF'},
  {name:'rosa', hex:'#F50078', text:'#FFFFFF'},
  {name:'mof', hex:'#8E5AA6', text:'#FFFFFF'},
  {name:'hellgro', hex:'#BDBDBD', text:'#111'},
  {name:'donkelgro', hex:'#2F3B3B', text:'#FFFFFF'}
];

function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }

const pages = ["g1","g2","g3","g4","g5"];
let pageIdx = 0;
const flowLabel = document.getElementById('flowLabel');
function labelFor(i){ return `${i+1}. Spill`; }
function showPage(i){
  pageIdx = Math.max(0, Math.min(pages.length-1, i));
  pages.forEach((id,idx)=>document.getElementById(id).classList.toggle('hidden', idx!==pageIdx));
  flowLabel.textContent = labelFor(pageIdx);
}
document.getElementById('prev').onclick = ()=> showPage(pageIdx-1);
document.getElementById('next').onclick = ()=> showPage(pageIdx+1);

const speaker = document.getElementById('speaker');
async function playSound(src){ try{ if(speaker.src!==src) speaker.src=src; await speaker.play(); }catch(e){} }

/* Spill 1 */
const grid1 = document.getElementById('grid1');
document.getElementById('play1').onclick = ()=> playSound(audioUrl(target1));
let bag1 = shuffle([...Array(20)].map((_,i)=>i+1));
let target1 = null;

function layoutG1(){
  grid1.innerHTML = "";
  shuffle([...Array(20)].map((_,i)=>i+1)).forEach(n=>{
    const b = document.createElement('button');
    b.className = 'numToken';
    b.textContent = n;
    b.onclick = ()=> checkG1(n, b);
    grid1.appendChild(b);
  });
}
function nextG1(){
  if(bag1.length===0) bag1 = shuffle([...Array(20)].map((_,i)=>i+1));
  target1 = bag1.pop();
  playSound(audioUrl(target1)); // autoplay
}
function flash(el, ok){
  el.classList.remove('flash-good','flash-bad');
  void el.offsetWidth;
  el.classList.add(ok ? 'flash-good' : 'flash-bad');
  setTimeout(()=> el.classList.remove('flash-good','flash-bad'), 260);
}
function checkG1(n, el){
  if(n===target1){ flash(el,true); setTimeout(nextG1, 280); }
  else { flash(el,false); }
}

/* Spill 2 */
const grid2 = document.getElementById('grid2');
document.getElementById('play2').onclick = ()=> playSound(audioUrl(target2));
let bag2 = shuffle([...Array(20)].map((_,i)=>i+1));
let target2 = null;

function fitWord(el){
  let size = parseFloat(getComputedStyle(el).fontSize); // starting from CSS clamp
  const maxW = el.clientWidth - 18, maxH = el.clientHeight - 14;
  const fits = ()=> el.scrollWidth<=maxW && el.scrollHeight<=maxH;
  while(size>19 && !fits()){ size -= 1; el.style.fontSize = size+'px'; }
}
function layoutG2(){
  grid2.innerHTML = "";
  shuffle([...Array(20)].map((_,i)=>i+1)).forEach(n=>{
    const b = document.createElement('button');
    b.className = 'wordToken';
    b.textContent = WORDS[n];
    b.onclick = ()=> checkG2(n, b);
    grid2.appendChild(b);
    requestAnimationFrame(()=>fitWord(b));
  });
}
function nextG2(){
  if(bag2.length===0) bag2 = shuffle([...Array(20)].map((_,i)=>i+1));
  target2 = bag2.pop();
  playSound(audioUrl(target2)); // autoplay
}
function checkG2(n, el){
  if(n===target2){ flash(el,true); setTimeout(nextG2, 280); }
  else { flash(el,false); }
}

/* Spill 3 */
const play3 = document.getElementById('play3');
const reset3 = document.getElementById('reset3');
const slots = document.getElementById('slots');
const bank = document.getElementById('bank');
play3.onclick = ()=> playSound(audioUrl(target3));
reset3.onclick = ()=> rebuildG3(true); // restart same word

let bag3 = shuffle([10,11,12,13,14,15,16,17,18,19,20]);
let target3 = null;

function lettersOf(word){ return Array.from(word.replace(/\s+/g,'')); }

function rebuildG3(keepTarget=false){
  slots.innerHTML = ""; bank.innerHTML = "";
  if(!keepTarget){
    if(bag3.length===0) bag3 = shuffle([10,11,12,13,14,15,16,17,18,19,20]);
    target3 = bag3.pop();
  }
  playSound(audioUrl(target3)); // autoplay each round or after reset

  const word = WORDS[target3];
  const letters = lettersOf(word);

  letters.forEach(()=> slots.appendChild(Object.assign(document.createElement('div'),{className:'slot'})));
  shuffle([...letters]).forEach(ch=>{
    const el = Object.assign(document.createElement('div'),{className:'letter',textContent:ch});
    el.draggable = true; bank.appendChild(el);
  });
  enableDnd();
}

function enableDnd(){
  bank.querySelectorAll('.letter').forEach(el=>{
    el.addEventListener('dragstart', e=>{ e.dataTransfer.setData('text/plain', el.textContent); el.classList.add('dragging'); });
    el.addEventListener('dragend', ()=> el.classList.remove('dragging'));
    el.addEventListener('click', ()=>{
      const empty = [...slots.children].find(s=>!s.textContent);
      if(empty){ empty.textContent = el.textContent; el.remove(); checkG3(); }
    });
  });
  [bank, slots].forEach(area=>{
    area.addEventListener('dragover', e=> e.preventDefault());
    area.addEventListener('drop', e=>{
      e.preventDefault();
      const drag = document.querySelector('.dragging'); if(!drag) return;
      if(area===slots){
        const empty = [...slots.children].find(s=>!s.textContent);
        if(empty){ empty.textContent = drag.textContent; drag.remove(); checkG3(); }
      } else { bank.appendChild(drag); }
    });
  });
  slots.querySelectorAll('.slot').forEach(s=>{
    s.addEventListener('click', ()=>{
      if(s.textContent){
        const back = Object.assign(document.createElement('div'),{className:'letter',textContent:s.textContent});
        back.draggable = true; bank.appendChild(back); s.textContent=''; enableDnd();
      }
    });
  });
}

function checkG3(){
  const attempt = [...slots.children].map(s=>s.textContent||'').join('');
  const target = WORDS[target3].replace(/\s+/g,'');
  if(attempt.length===target.length){
    if(attempt===target){
      slots.classList.add('goodFlash');
      setTimeout(()=>{ slots.classList.remove('goodFlash'); rebuildG3(false); }, 800);
    } else {
      slots.classList.add('badFlash');
      setTimeout(()=> slots.classList.remove('badFlash'), 600);
      // user can correct or hit Zerécksetzen
    }
  }
}

/* Spill 4 */
const bigSquare = document.getElementById('bigSquare');
const bigNum = document.getElementById('bigNum');
const bigReset = document.getElementById('bigReset');
let bag4 = [];
function refill4(){ bag4 = shuffle([...Array(20)].map((_,i)=>i+1)); }
function next4(){
  if(bag4.length===0){ showPage(4); initG5(); return; }
  const n = bag4.pop();
  bigNum.textContent = n;
  bigNum.classList.remove('fade'); void bigNum.offsetWidth; bigNum.classList.add('fade');
}
function reset4(){ refill4(); bigNum.textContent='—'; }
bigSquare.addEventListener('click', (e)=>{ if(e.target===bigReset) return; next4(); });
bigReset.addEventListener('click', (e)=>{ e.stopPropagation(); reset4(); });

/* Spill 5 */
const numSq = document.getElementById('numSq');
const numSqVal = document.getElementById('numSqVal');
const colSq = document.getElementById('colSq');
const reshuffleBoth = document.getElementById('reshuffleBoth');
let bag5=[]; let colourBag=[];
function refill5(){ bag5 = shuffle([...Array(20)].map((_,i)=>i+1)); }
function refillColours(){ colourBag = shuffle([...COLOURS]); }
function nextNum5(){ if(bag5.length===0) refill5(); const n=bag5.pop(); numSqVal.textContent=n; numSqVal.classList.remove('fade'); void numSqVal.offsetWidth; numSqVal.classList.add('fade'); }
function nextColour5(){ if(colourBag.length===0) refillColours(); const c=colourBag.pop(); colSq.style.background=c.hex; colSq.style.color=c.text; colSq.classList.remove('fade'); void colSq.offsetWidth; colSq.classList.add('fade'); }
numSq.addEventListener('click', nextNum5);
colSq.addEventListener('click', nextColour5);
reshuffleBoth.addEventListener('click', ()=>{ refill5(); refillColours(); nextNum5(); nextColour5(); });
function initG5(){ if(!bag5.length) refill5(); if(!colourBag.length) refillColours(); nextNum5(); nextColour5(); }

/* Init all */
function init(){
  // g1
  layoutG1(); nextG1();
  // g2
  layoutG2(); nextG2();
  // g3
  rebuildG3(false);
  // g4
  reset4();
  // start
  showPage(0);
}
init();
</script>
</body>
</html>
